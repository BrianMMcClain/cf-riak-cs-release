#!/usr/bin/env bash

set -e # exit immediately if a simple command exits with a non-zero status
set -u # report the usage of uninitialized variables
set +x

#compile
export GOROOT=$(readlink -nf /var/vcap/packages/golang)
export PATH=/var/vcap/packages/git/bin:$PATH
export PATH=$GOROOT/bin:$PATH

export GOPATH=$PWD/route_registrar

go install registrar_app

#copy the executable file to bosh install target folder
cp -a $GOPATH/bin/registrar_app ${BOSH_INSTALL_TARGET}
